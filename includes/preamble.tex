% taken from Minho's thesis

% preamble.tex -- packages to include
%
% Wisconsin dissertation template
% Copyright (c) 2008 William C. Benton.  All rights reserved.
%
% This program can redistributed and/or modified under the terms
% of the LaTeX Project Public License Distributed from CTAN
% archives in directory macros/latex/base/lppl.txt; either
% version 1 of the License, or (at your option) any later version.
%
% This program includes other software that is licensed under the
% terms of the LPPL and the Perl Artistic License; see README for details.
%
% You, the user, still hold the copyright to any document you produce
% with this software (like your dissertation).

%% You should use natbib
% \IfFileExists{natbib.sty}{%
% \usepackage[square,numbers]{natbib}%
% %\bibliographystyle{unsrtnat}
% }{}
%\usepackage[square,numbers]{natbib}%


%% You probably need appendix, if you want appendices
\IfFileExists{appendix.sty}{%
\usepackage{appendix}%
}{}

%% the spacing in memoir is weird, you'll need to use this
\DisemulatePackage{setspace}
\usepackage[onehalfspacing]{setspace}
%\usepackage[doublespacing]{setspace}

% Applying spacing only at the desired section can be achieved by sandwiching commands such as
%\begin{doublespacing}
%\end{doublespacing}

%% geometry package to help with margins on title page
\usepackage{geometry}

%% for tables in landscape mode - PH, added 2022
\usepackage{rotating}

%% List setup; the ``hanglist`` environment will allow you to have
%% nicely-typeset enumerated lists (i.e. with the numbers hanging in
%% the margins).  You need at least version 2.1 of enumitem.sty.  If
%% you don't have enumitem installed at all, hanglist will just be an
%% alias for enumerate.
\IfFileExists{enumitem.sty}{%
\usepackage[loadonly]{enumitem}[2007/06/30]%
\newlist{hanglist}{enumerate}{1}% 
\setlist[hanglist]{label=\arabic*.}%
\setlist[hanglist,1]{leftmargin=0pt}%
}{%
\newenvironment{hanglist}{\begin{enumerate}}{\end{enumerate}}%
}

%% Comment out any of these that you don't want
\usepackage{amssymb}
% \usepackage{amsmath}
\usepackage{mathtools} % for equation alignment; loads amsmath
\usepackage{amsthm}
\usepackage{hyperref}
\usepackage{subcaption}
\hypersetup{colorlinks=True}
\usepackage{grffile} % For extended file name
\usepackage{braket}
\usepackage{color}
\usepackage{xcolor}
\usepackage{physics}
\usepackage{bm}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\IfFileExists{mathpartir.sty}{%
\usepackage{mathpartir}%
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
}{}

%%%%% LISTINGS package and setup
\IfFileExists{listings.sty}{%
\usepackage{listings}%
}{}



%% Get rid of ugly borders around PDF hyperlinks (e.g. for cross-references, bib entries, or URLs)
\hypersetup{pdfborder = 0 0 0}

%% You want microtype.
\IfFileExists{microtype.sty}{%
\usepackage[protrusion=true,expansion=true]{microtype}%
}{}

%\pagestyle{thesisdraft}

% Surround parts of graphics with box
\usepackage{boxedminipage}

%% booktabs (thx to Nate Rosenblum for bringing this beautiful package
%% to my attention)
\IfFileExists{booktabs.sty}{%
\usepackage{booktabs}%
}{}

% This is now the recommended way for checking for PDFLaTeX:
\usepackage{ifpdf}

%% Avoid ugly "Type 3" fonts
% \usepackage{lmodern}
% \usepackage[LY1]{fontenc}

%% Substitute your favorite serif and sans fonts here....
\IfFileExists{tgpagella.sty}{%
% TeX Gyre pagella, like Palatino
\usepackage{tgpagella}%
}{}

% \usepackage[LY1]{eulervm}

% this block throws a package options conflict error
% \ifpdf
% \usepackage[pdftex]{graphicx}
% \else
% \usepackage{graphicx}
% \fi

% \usepackage{makeidx}
% \makeindex

% {\theoremstyle{plain}
% \newtheorem{thm}{Theorem}[chapter]
% \newtheorem{cor}[thm]{Corollary}
% \newtheorem{define}[thm]{Definition}
% \newtheorem{exmpl}[thm]{Example}
% }
% {\theoremstyle{remark}
% \newtheorem{rmk}[thm]{Remark}
% }

% \newtheoremstyle{customsty1}
% {3pt}%
% {3pt}%
% {}% --- body font
% {}% --- indent amount
% {\bfseries}% --- Theorem head font
% {:}% --- Punctuation after head
% {.5em}% --- space after head
% {}% --- theorem head spec (can be left empty, meaning 'normal')

% % Define 'newtheorems' that use ``customsty1''
% {\theoremstyle{customsty1} 
% }


%%% NB: the ``deposit'' chapter- and page- styles should conform to UW
%%% requirements.  If you are producing a pretty version of your
%%% dissertation for web use later, you will certainly want to make
%%% your own chapter and page styles.

\makechapterstyle{deposit}{%
  \renewcommand{\chapterheadstart}{}
  \renewcommand{\printchaptername}{}
  \renewcommand{\chapternamenum}{}
  \renewcommand{\printchapternum}{\parbox{2em}{\MakeLowercase{\Large\scshape\thechapter{}}} }
  \renewcommand{\afterchapternum}{}
  \renewcommand{\printchaptertitle}[1]{%
  \raggedright\Large\scshape\MakeLowercase{##1}}
  \renewcommand{\afterchaptertitle}{%
  \vskip\onelineskip \hrule\vskip\onelineskip}
}

\makepagestyle{deposit}
 
\makeatletter
 
\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markboth{#1}{}}
 
\makeevenfoot{deposit}{}{}{}
\makeoddfoot{deposit}{}{}{}
\makeevenhead{deposit}{\thepage}{}{}
\makeoddhead{deposit}{}{}{\thepage}
\makeatother

%%% set up page numbering for chapter pages to satisfy UW requirements
%%% NB: You will want to delete until the ``SNIP'' mark if you are
%%% making a ``nice'' copy
\copypagestyle{chapter}{plain}
\makeoddfoot{chapter}{}{}{}
\makeevenhead{chapter}{\thepage}{}{}
\makeoddhead{chapter}{}{}{\thepage}
%%% SNIP

% Display upto subsections
\setcounter{tocdepth}{2}

% numbering upto subsections
\setcounter{secnumdepth}{2}

%%% bib nonsense
% \makeatletter
% \newenvironment{wb-bib}[1]{%
%   \chapter*{references}
% \ifnobibintoc\else 
% \phantomsection 
% \addcontentsline{toc}{chapter}{References} 
% \fi 
% \prebibhook
%   \begin{bibitemlist}{#1}}{\end{bibitemlist}\postbibhook}

% \AtBeginDocument{%
%   \@ifpackageloaded{natbib}{% natbib is loaded
%     \addtodef{\endthebibliography}{}{\vskip-\lastskip\postbibhook}
%     \@ifpackagewith{natbib}{sectionbib}{% with sectionbib option
%       \renewcommand{\bibsection}{\@memb@bsec}}%
%       {\renewcommand{\bibsection}{\@memb@bchap}}}%
%   {}
%   \@ifpackagewith{chapterbib}{sectionbib}{%
%     \renewcommand{\sectionbib}[2]{}
%     \renewcommand{\bibsection}{\@memb@bsec}}{}
% }
% \makeatother
% \usepackage[style=numeric-comp,backend=bibtex,sorting=none,maxbibnames=99]{biblatex}  % to use bibtex
% \bibliography{optics,qc_refs,rydberg,saffman_refs,huft_bib}  % to use bibtex.  Put bibliography filename here.
% \AtEveryBibitem{
%  \clearfield{eprint}
%  \clearfield{issn}
%  \clearlist{location}
%  \clearfield{month}
%  \clearfield{series}
%  \clearname{editor}
% }
% \usepackage[style=numeric-comp,backend=bibtex,sorting=none,maxbibnames=99]{biblatex}  % to use bibtex
\usepackage[style=numeric-comp,backend=bibtex,sorting=none,maxbibnames=99]{biblatex}  % to use biber
\bibliography{bib/atomic,bib/optics,bib/qc_refs,bib/rydberg,bib/saffman_refs,bib/huft_bib}  % to use bibtex.  Put bibliography filename here.
% \bibliography{bib/atomic, bib/huft_bib}  % to use bibtex.  Put bibliography filename here.
\AtEveryBibitem{
 \clearfield{eprint}
 \clearfield{issn}
 \clearlist{location}
 \clearfield{month}
 \clearfield{series}
 \clearname{editor}
}

% added by MTL, script to use DOI or URL in reference, but not both
% from http://tex.stackexchange.com/questions/154864/biblatex-use-doi-only-if-there-is-no-url
    \renewbibmacro*{doi+eprint+url}{%
     \iftoggle{bbx:url} {\iffieldundef{doi}{\usebibmacro{url+urldate}}{}} {}%
      \newunit\newblock \iftoggle{bbx:eprint} {\usebibmacro{eprint}} {}%
       \newunit\newblock \iftoggle{bbx:doi} {\printfield{doi}} {}}
       
% added by PH, for adjusting table strut spacing
\newcommand\T{\rule{0pt}{4ex}}       % Top strut - use in tabular modes
\newcommand\B{\rule[-2ex]{0pt}{0pt}} % Bottom strut. 